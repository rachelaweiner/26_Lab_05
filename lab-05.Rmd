---
title: "Lab 05 - La Quinta is Spanish for next to Denny's, Pt. 2"
author: "Rachel Weiner"
date: "February 12, 2026"
output: github_document
---

### Load packages and data

```{r load-packages, message = FALSE}
library(tidyverse) 
library(dsbox) 
```

```{r load-data, message = FALSE}
states <- read_csv("data/states.csv")
```

```{r load-data-sets}
data(dennys)
data(laquinta)
```

### Exercise 1

Back to the Denny's and La Quinta data sets! First, I will start by filtering the Dennys data set for only Alaska locations.

```{r count-rows-dennys}
dn_ak <- dennys %>%
  filter(state == "AK")
nrow(dn_ak)
```

There are three Denny's locations in the state of Alaska. Now for the La Quinta locations.

```{r count-rows-laquinta}
lq_ak <- laquinta %>%
  filter(state == "AK")
nrow(lq_ak)
```

There are 2 total La Quinta locations in the state of Alaska.

### Exercise 2

Now we are interested in the distances between each Denny's location from each La Quinta location. To do so, we must calculate the distance between six total pairings, for each of the three Dennys locations, I will compare them to the two La Quinta locations to measure six total distances. 

### Exercise 3

To do so, we will begin by joining our data sets that we are more easily able to compare distances through pairing.

```{r join-data-frames}
dn_lq_ak <- full_join(dn_ak, lq_ak,
  by = "state")
dn_lq_ak
```

Now we have a separate data frame with all six combinations of our two organizations. 

### Exercise 4

```{r view-joined-data-frame}
view(dn_lq_ak)
```

In this new data frame that we just created, there are six total observations which each represent a pairing of a Denny's locations and a La Quinta location. The names in this data frame are similar to those of the original data frames but are doubled to represent both the Dennys location and the La Quinta location. Variables include address, city, state, zip, longitude, and latitude. The Denny's locations are marked with .x after these variables while the La Quinta location variables end with .y to seperate these two data frames. 

### Exercise 5

```{r load-haversine-package}
haversine <- function(long1, lat1, long2, lat2, round = 3) {
  long1 <- long1 * pi / 180
  lat1 <- lat1 * pi / 180
  long2 <- long2 * pi / 180
  lat2 <- lat2 * pi / 180

  R <- 6371 

  a <- sin((lat2 - lat1) / 2)^2 + cos(lat1) * cos(lat2) * sin((long2 - long1) / 2)^2
  d <- R * 2 * asin(sqrt(a))

  return(round(d, round))
}
```

### Exercise 6

Now I will calculate each of the six distances to create a new distance variable for each pairing. 

```{r calculate-distance}
dn_lq_ak <- dn_lq_ak %>%
  mutate(distance = mapply(haversine, 
                           longitude.x, latitude.x, 
                           longitude.y, latitude.y))
```

### Exercise 7

Now with this new variable, I will calculate the minimum distance between a Denny's and a La Quinta for each Denny's location.

```{r}
dn_min_dist <- dn_lq_ak %>%
  group_by(address.x) %>% 
  summarize(closest_lq_dist = min(distance, na.rm = TRUE))

head(dn_min_dist)
```


